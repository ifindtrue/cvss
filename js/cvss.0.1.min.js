(function(H){H.Canvas=function(b){b&&this.target(b)};H.Canvas.reference_canvas=[];Canvas.prototype.target=function(b){var d=document.getElementById(b.substring(1));if(!d)return console.error("CvSS ERROR : not found element '"+b+"'"),0;var e=d.getContext("2d");if(e){this.$canvas=d;this.$context=e;this.$element={};this.$elementKey={};this.$canvas.addEventListener("mousemove",function(b){Canvas.prototype.canvasMouseOver.apply(c,[b])});this.$canvas.addEventListener("mousedown",function(b){Canvas.prototype.canvasMouseEvent.apply(c,
[b,"mousedown"])});this.$canvas.addEventListener("mouseup",function(b){Canvas.prototype.canvasMouseEvent.apply(c,[b,"mouseup"])});this.$canvas.addEventListener("mouseout",function(){c.$preOver&&c.$eventFunc[c.$preOver]&&"function"==typeof c.$eventFunc[c.$preOver].mouseout?c.$eventFunc[c.$preOver].mouseout.apply(c,[NaN,c.$preOver]):c.$preOver&&c.$element[c.$preOver]&&c.$element[c.$preOver].baseEventElement&&c.$eventFunc[c.$element[c.$preOver].baseEventElement]&&"function"==typeof c.$eventFunc[c.$element[c.$preOver].baseEventElement].mouseout&&
c.$eventFunc[c.$element[c.$preOver].baseEventElement].mouseout.apply(c,[NaN,c.$preOver]);c.$dragOn&&c.$eventFunc[c.$dragElement]&&"function"==typeof c.$eventFunc[c.$dragElement].drop?c.$eventFunc[c.$dragElement].drop.apply(c,[NaN,c.$dragElement]):c.$dragOn&&c.$element[c.$dragElement].baseEventElement&&c.$element[c.$dragElement].baseEventElement&&c.$eventFunc[c.$element[c.$dragElement].baseEventElement]&&"function"==typeof c.$eventFunc[c.$element[c.$dragElement].baseEventElement].drop&&c.$eventFunc[c.$element[c.$dragElement].baseEventElement].drop.apply(c,
[NaN,c.$dragElement]);c.$preOver=void 0;c.$canvas.style.cursor="default";c.$dragOn=!1;c.$preEvent=void 0;c.$preEventType=void 0});var c=this;this.$canvas.onselectstart=function(){return!1};this.$preEventType=this.$preEvent=this.$preOver=void 0;this.$dblclickTimer=!1;this.$dblclickTimerFunc=void 0;this.$dragOn=!1;this.$dargElement=void 0;this.$eventFunc={};this.$windowEvent={};this.$event={};this.$imageData=[];this.$imageSrc=[];this.$imageDataMatch={};return 1}console.error("CvSS ERROR : not found canvas '"+
b+"'");return 0};Canvas.prototype.polygonInsideCheck=function(b,d,e){e="object"==typeof d?d.length:0;if(2>=e)return 0;var c=[0,0],l,f;for(l=0;l<e;l++)if(f=l==e-1?0:l+1,d[l][1]<b.y&&b.y<=d[f][1]||d[f][1]<b.y&&b.y<=d[l][1])(-b.y+d[l][1])*(d[f][0]-d[l][0])/(-d[f][1]+d[l][1])+d[l][0]<=b.x?c[0]++:c[1]++;return 1==c[0]%2&&1==c[1]%2?1:0};Canvas.prototype.canvasMouseOver=function(b){b=Canvas.prototype.getRealMousePosition(b);var d;"function"==typeof this.$windowEvent.mousemove&&this.$windowEvent.mousemove.apply(this,
[b]);"mousedown"==this.$preEventType&&(!1===this.$dragOn?(this.$dragOn=!0,this.$dragElement=this.$preEvent,this.$eventFunc[this.$dragElement]&&"function"==typeof this.$eventFunc[this.$dragElement].dragstart?this.$eventFunc[this.$dragElement].dragstart.apply(this,[b,this.$dragElement]):this.$element[this.$dragElement].baseEventElement&&this.$eventFunc[this.$element[this.$dragElement].baseEventElement]&&"function"==typeof this.$eventFunc[this.$element[this.$dragElement].baseEventElement].dragstart&&
this.$eventFunc[this.$element[this.$dragElement].baseEventElement].dragstart.apply(this,[b,this.$dragElement])):this.$eventFunc[this.$dragElement]&&"function"==typeof this.$eventFunc[this.$dragElement].drag?this.$eventFunc[this.$dragElement].drag.apply(this,[b,this.$dragElement]):this.$element[this.$dragElement].baseEventElement&&this.$eventFunc[this.$element[this.$dragElement].baseEventElement]&&"function"==typeof this.$eventFunc[this.$element[this.$dragElement].baseEventElement].drag&&this.$eventFunc[this.$element[this.$dragElement].baseEventElement].drag.apply(this,
[b,this.$dragElement]));var e=!1,c;for(d=this.$elementKey.length-1;0<=d;d--)if(c=this.$element[this.$elementKey[d]],!1!==c.show&&!0!==c.onlyBaseElement){var l=this.$event[this.$elementKey[d]];switch(c.type){case "block":e=Canvas.prototype.polygonInsideCheck({x:b.x,y:b.y},l.line);break;case "path":e=Canvas.prototype.polygonInsideCheck({x:b.x,y:b.y},l.line);break;case "circle":l=this.$event[this.$elementKey[d]].c,Math.sqrt(Math.pow(b.x-l.x,2)+Math.pow(b.y-l.y,2))+Math.sqrt(Math.pow(b.x-l.mirrorx,2)+
Math.pow(b.y-l.mirrory,2))<2*this.$event[this.$elementKey[d]].a&&(e=!0)}if(e){d=this.$elementKey[d];this.$canvas.style.cursor=c.cursor||this.$initElement.cursor;if(this.$preOver==d)return 0;this.$preOver&&this.$preOver!=d&&this.$eventFunc[this.$preOver]&&"function"==typeof this.$eventFunc[this.$preOver].mouseout?this.$eventFunc[this.$preOver].mouseout.apply(this,[b,this.$preOver]):this.$preOver&&this.$preOver!=d&&this.$element[this.$preOver].baseEventElement&&this.$eventFunc[this.$element[this.$preOver].baseEventElement]&&
"function"==typeof this.$eventFunc[this.$element[this.$preOver].baseEventElement].mouseout&&this.$eventFunc[this.$element[this.$preOver].baseEventElement].mouseout.apply(this,[b,this.$preOver]);this.$preOver=d;this.$eventFunc[d]&&"function"==typeof this.$eventFunc[d].mousein?this.$eventFunc[d].mousein.apply(this,[b,d]):c.baseEventElement&&this.$eventFunc[c.baseEventElement]&&"function"==typeof this.$eventFunc[c.baseEventElement].mousein&&this.$eventFunc[c.baseEventElement].mousein.apply(this,[b,d]);
return 0}}this.$preOver&&this.$eventFunc[this.$preOver]&&"function"==typeof this.$eventFunc[this.$preOver].mouseout?this.$eventFunc[this.$preOver].mouseout.apply(this,[b,this.$preOver]):this.$preOver&&this.$element[this.$preOver]&&this.$element[this.$preOver].baseEventElement&&this.$eventFunc[this.$element[this.$preOver].baseEventElement]&&"function"==typeof this.$eventFunc[this.$element[this.$preOver].baseEventElement].mouseout&&this.$eventFunc[this.$element[this.$preOver].baseEventElement].mouseout.apply(this,
[b,this.$preOver]);this.$preOver=void 0;this.$canvas.style.cursor="default"};Canvas.prototype.canvasMouseEvent=function(b,d){var e=Canvas.prototype.getRealMousePosition(b),c;"function"==typeof this.$windowEvent[d]&&this.$windowEvent[d].apply(this,e);"mouseup"==d&&this.$dragOn&&(this.$dragOn=!1,this.$eventFunc[this.$dragElement]&&"function"==typeof this.$eventFunc[this.$dragElement].drop?this.$eventFunc[this.$dragElement].drop.apply(this,[e,this.$dragElement]):this.$element[this.$dragElement].baseEventElement&&
this.$element[this.$dragElement].baseEventElement&&this.$eventFunc[this.$element[this.$dragElement].baseEventElement]&&"function"==typeof this.$eventFunc[this.$element[this.$dragElement].baseEventElement].drop&&this.$eventFunc[this.$element[this.$dragElement].baseEventElement].drop.apply(this,[NaN,this.$dragElement]));var l=!1,f;for(c=this.$elementKey.length-1;0<=c;c--)if(f=this.$element[this.$elementKey[c]],!1!==f.show&&!0!==f.onlyBaseElement){var a=this.$event[this.$elementKey[c]];switch(f.type){case "block":l=
Canvas.prototype.polygonInsideCheck({x:e.x,y:e.y},a.line);break;case "path":l=Canvas.prototype.polygonInsideCheck({x:e.x,y:e.y},a.line);break;case "circle":a=this.$event[this.$elementKey[c]].c,Math.sqrt(Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2))+Math.sqrt(Math.pow(e.x-a.mirrorx,2)+Math.pow(e.y-a.mirrory,2))<2*this.$event[this.$elementKey[c]].a&&(l=!0)}if(l){"mousedown"==d&&this.$preEvent!=this.$elementKey[c]&&(clearTimeout(this.$dblclickTimerFunc),this.$dblclickTimer=!1);if("mouseup"==d&&this.$preEvent==
this.$elementKey[c]&&"mousedown"==this.$preEventType)if(d="click",this.$dblclickTimerFunc=setTimeout(function(){w.$dblclickTimer=!1},500),1==this.$dblclickTimer)clearTimeout(this.$dblclickTimerFunc),this.$dblclickTimer=!1,d="dblclick";else{var w=this;this.$dblclickTimer=!0;this.$dblclickTimerFunc=setTimeout(function(){w.$dblclickTimer=!1},500)}this.$preEvent=this.$elementKey[c];this.$preEventType=d;this.$canvas.style.cursor=f.cursor||this.$initElement.cursor;this.$eventFunc[this.$elementKey[c]]&&
"function"==typeof this.$eventFunc[this.$elementKey[c]][d]?this.$eventFunc[this.$elementKey[c]][d].apply(this,[e,this.$elementKey[c]]):f.baseEventElement&&this.$eventFunc[f.baseEventElement]&&"function"==typeof this.$eventFunc[f.baseEventElement][d]&&this.$eventFunc[f.baseEventElement][d].apply(this,[e,this.$elementKey[c]]);return 0}}this.$preEventType=this.$preEvent=void 0};Canvas.prototype.getRealMousePosition=function(b){var d;d=b.originalEvent||b;var e=(b.currentTraget||b.srcElement).getBoundingClientRect();
d.touches?(b=d.touches[0].clientX-e.left,d=d.touches[0].clientY-e.top):(b=d.clientX-e.left,d=d.clientY-e.top);return{x:parseInt(b),y:parseInt(d)}};Canvas.prototype.numberFormat=function(b,d,e,c){"number"==typeof d||d||(d=e);if("string"==typeof b){"px"==b.substring(b.length-2)&&!1!==c&&(b=b.substring(0,b.length-2));switch(b.substring(0,2)){case "+=":b=Number(d)+Number(b.substring(2));break;case "-=":b=Number(d)-Number(b.substring(2))}b=Number(b)}return b?b:e};Canvas.prototype.persentFormat=function(b,
d,e){var c="";"string"!=typeof d||"+="!=d.substring(0,2)&&"-="!=d.substring(0,2)||(c=d.substring(0,2),d=d.substring(2));switch(typeof d){case "string":d="px"==d.substring(d.length-2,d.length)?Number(d.substring(0,d.length-2))||e:"%"==d.substring(d.length-1,d.length)?b/100*Number(d.substring(0,d.length-1))||e:Number(d)||e;break;case "number":break;default:d=e}return""==c?d:c+d};Canvas.prototype.setBaseObj=function(b,d,e,c){var l=Object.keys(d);b=Canvas.prototype.CopyObj(b);c&&e&&delete b.onlyBaseElement;
for(var f=0;f<l.length;f++){var a=l[f];e&&"onlyBaseElement"!=a&&"show"!=a&&("none"==d[a]||"number"!=typeof d[a]&&!d[a])?c||(delete b[a],e?b.$temp=!0:b[a].$temp=!0):(b[a]=d[a],e?b.$temp=!0:b[a].$temp=!0)}return b};Canvas.prototype.createElement=function(b,d){var e,c;if(!this.$context)return console.error("CvSS ERROR : not found target canvas"),0;var l,f;if(!b)return 0;if("string"==typeof b||"number"==typeof b){var a=b;if("object"==typeof d)b={},b[a]=Canvas.prototype.setBaseObj(this.$element[a],d,!0);
else return 0}else if("object"!=typeof b)return 0;b=Canvas.prototype.setBaseObj(this.$element,b);this.$context.clearRect(0,0,this.$canvas.width,this.$canvas.height);var w=Object.keys(b),g=this.$initElement,m=Canvas.prototype.numberFormat,u=Canvas.prototype.persentFormat,w=w.sort(function(a,c){return(b[a].zindex||g.zindex)<(b[c].zindex||g.zindex)?-1:(b[a].zindex||g.zindex)>(b[c].zindex||g.zindex)?1:0}),H=Canvas.prototype.$backgroundRepeatType,M=Canvas.prototype.$lineJoin;this.$elementKey=w;for(l=0;l<
w.length;l++){var h=NaN,k=NaN,q=f=NaN,r=NaN;c=e=0;var v=NaN,A=r=NaN,z=NaN,p=NaN,C=p=NaN,K=NaN,a=b[w[l]];$element=this.$element[w[l]];this.$context.save();"string"==typeof a.baseElement&&($element&&$element.baseElement)!=a.baseElement&&(a.baseStyleElement=($element&&$element.baseStyleElement)==a.baseStyleElement?a.baseElement:a.baseStyleElement,a.baseEventElement=($element&&$element.baseEventElement)==a.baseEventElement?a.baseElement:a.baseEventElement);"string"==typeof a.baseStyleElement&&"object"==
typeof b[a.baseStyleElement]&&(a=Canvas.prototype.setBaseObj(b[a.baseStyleElement],a,!0,!0));-1==this.$Element_Type.indexOf(a.type)&&(a.type=g.type);a.opacity=m(a.opacity,$element&&$element.opacity||0,g.opacity);this.$context.globalAlpha=a.opacity;this.$event[w[l]]||(this.$event[w[l]]={});event=this.$event[w[l]];switch(a.type){case "block":if(a.$temp||!$element){a.width=m(u(this.$canvas.width,a.width,g.width),$element&&$element.width||0,g.width);a.height=m(u(this.$canvas.height,a.height,g.height),
$element&&$element.height||0,g.height);a.x=m(u(this.$canvas.width,a.x,g.x),$element&&$element.x,g.x);a.y=m(u(this.$canvas.height,a.y,g.y),$element&&$element.y,g.y);f=a.width;a.minWidth&&(a.minWidth=m(u(this.$canvas.width,a.minWidth,0),$element&&$element.minWidth||0,0),f=a.minWidth<a.width?a.width:a.minWidth);a.maxWidth&&(a.maxWidth=m(u(this.$canvas.width,a.maxWidth,f),$element&&$element.maxWidth||0,f),f=a.maxWidth<f?a.maxWidth:f);q=a.height;a.minHeight&&(a.minHeight=m(u(this.$canvas.height,a.minHeight,
0),$element&&$element.minHeight||0,0),q=a.minHeight<a.height?a.height:a.minHeight);a.maxHeight&&(a.maxHeight=m(u(this.$canvas.height,a.maxHeight,q),$element&&$element.maxHeight||0,q),q=a.maxHeight<q?a.maxHeight:q);h=a.x;k=a.y;p="string"==typeof a.origin?a.origin.split(" "):g.origin;h-=u(a.width,p[0],g.origin[0]);k-=u(a.height,p[1],g.origin[1]);this.$context.fillStyle=a.background?a.background:g.background;if(!$element&&"string"==typeof a.border||"string"==typeof a.border&&$element&&$element.border!=
a.border)p=a.border.split(" "),e=m(p[0],0,g.borderWidth),this.$context.lineWidth=e,c=p[2]||g.borderColor,this.$context.strokeStyle=c;e||(e=m(a.borderWidth,$element&&$element.borderWidth||0,g.borderWidth),this.$context.lineWidth=e);c||(c=a.borderColor||g.borderColor,this.$context.strokeStyle=c);a.borderWidth=e;a.borderColor=c;a.border=e+" solid "+c;if(a.backgroundImage){"string"==typeof a.backgroundImage&&(r=a.backgroundImage.split(" "),A=r[0]||g.backgroundImage.src,z=-1!=H.indexOf(r[1])?r[1]:g.backgroundImage.pattern,
v=m(r[2],$element&&$element.backgroundImageX||0,0),r=m(r[3],$element&&$element.backgroundImageY||0,0));if(!$element&&a.backgroundImageSrc||$element&&$element.backgroundImageSrc!=a.backgroundImageSrc)A=a.backgroundImageSrc;if(!$element&&a.backgroundImagePattern||$element&&$element.backgroundImagePattern!=a.backgroundImagePattern)z=-1==H.indexOf(a.backgroundImagePattern)?g.backgroundImage.pattern:a.backgroundImagePattern;if(!$element&&"number"==typeof a.backgroundImageX||$element&&$element.backgroundImageX!=
a.backgroundImageX)v=m(a.backgroundImageX,$element&&$element.backgroundImageX||0,0);if("number"==(!$element&&typeof a.backgroundImageY)||$element&&$element.backgroundImageY!=a.backgroundImageY)r=m(a.backgroundImageY,$element&&$element.backgroundImageY||0,0);a.backgroundImage=A+" "+z+" "+v+" "+r;a.backgroundImageSrc=A;a.backgroundImagePattern=z;a.backgroundImageX=v;a.backgroundImageY=r}a.translateX&&(a.translateX=m(u(a.width,a.translateX,g.translate.x),$element&&$element.translateX,g.translate.x));
a.translateY&&(a.translateY=m(u(a.height,a.translateY,g.translate.y),$element&&$element.translateY,g.translate.y));"number"==typeof a.scaleX&&(a.scaleX=m(u(a.width,a.scaleX,g.scale.x),$element&&$element.scaleX,g.scale.x));"number"==typeof a.scaleY&&(a.scaleY=m(u(a.height,a.scaleY.initElement.scale.y),$element&&$element.scaleY,g.scale.y));e="number"==typeof a.translateX?a.translateX:g.translate.x;c="number"==typeof a.translateY?a.translateY:g.translate.y;if(a.rotate){a.rotate=m(a.rotate,$element&&
$element.rotate,g.rotate,!1);a.rotateOriginX=m(u(a.width,a.rotateOriginX,g.rotateOrigin.x),$element&&$element.rotateOriginX,g.rotateOrigin.x);a.rotateOriginY=m(u(a.height,a.rotateOriginY,g.rotateOrigin.y),$element&&$element.rotateOriginY,g.rotateOrigin.y);var p=Math.cos(a.rotate*Math.PI/180),B=Math.sin(a.rotate*Math.PI/180);event.line=[[-a.rotateOriginX*p+a.rotateOriginY*B+h+a.rotateOriginX+e,-a.rotateOriginX*B-a.rotateOriginY*p+k+a.rotateOriginY+c],[(f-a.rotateOriginX)*p+a.rotateOriginY*B+h+a.rotateOriginX+
e,(f-a.rotateOriginX)*B-a.rotateOriginY*p+k+c+a.rotateOriginY],[(f-a.rotateOriginX)*p-(q-a.rotateOriginY)*B+h+a.rotateOriginX+e,(f-a.rotateOriginX)*B+(q-a.rotateOriginY)*p+k+a.rotateOriginY+c],[-a.rotateOriginX*p-(q-a.rotateOriginY)*B+h+a.rotateOriginX+e,-a.rotateOriginX*B+(q-a.rotateOriginY)*p+k+a.rotateOriginY+c]]}else event.line=[[h+e,k+c],[h+f+e,k+c],[h+f+e,k+q+c],[h+e,k+q+c]];t=event.line;delete a.$temp}else h=a.$x,k=a.$y,f=a.width,q=a.height,this.$context.fillStyle=a.background?a.background:
g.background,this.$context.lineWidth=a.borderWidth,this.$context.strokeStyle=a.borderColor,a.backgroundImage&&(v=a.backgroundImageX,r=a.backgroundImageY,z=a.backgroundImagePattern,A=a.backgroundImageSrc),e="number"==typeof a.translateX?a.translateX:g.translate.x,c="number"==typeof a.translateY?a.translateY:g.translate.y;if(a.backgroundImage){var L=this.$imageSrc.indexOf(A);if(-1==L){var p=new Image,F=this;p.onload=function(){F.$imageData.push(this);F.$imageSrc.push(this.src);F.$imageDataMatch[w[l]]=
F.$imageData.length-1;F.createElement(F.$element)};p.src=A;a.$backgroundImage={width:NaN,height:NaN}}else{var n=this.$imageData[L],x=f<n.width?f:n.width,y=q<n.height?q:n.height;a.$backgroundImage={width:n.width,height:n.height}}}if(!1===a.show||"false"==a.show){a.show=!1;this.$element[w[l]]=a;this.$context.restore();continue}if(!0===a.onlyBaseElement||"true"==a.onlyBaseElement){a.onlyBaseElement=!0;this.$element[w[l]]=a;this.$context.restore();continue}this.$context.translate(e,c);a.rotate&&(C=h,
K=k,this.$context.translate(h+a.rotateOriginX,k+a.rotateOriginY),h=-a.rotateOriginX,k=-a.rotateOriginY,this.$context.rotate(a.rotate*Math.PI/180));0<a.borderWidth&&this.$context.strokeRect(h-a.borderWidth/2,k-a.borderWidth/2,f+a.borderWidth,q+a.borderWidth);this.$context.fillRect(h,k,f,q);if(-1!==L)if("no-repeat"==z)z=A=0,e=x,c=y,p=h+v,B=k+r,0>v?(A=-v,e=x,p=h):v+n.width>f&&(A=0,e=f-v),0>r?(z=-r,c=y,B=k):r+n.height>q&&(z=0,c=q-r),this.$context.drawImage(n,A,z,e,c,p,B,e,c);else if("repeat"==z){var v=
Math.ceil(f/n.width),r=Math.ceil(q/n.height),G=v*r,D=f%n.width,E=q%n.height;for(f=1;f<=G;f++)f==G?this.$context.drawImage(n,0,0,D,E,h+(v-1)*x,k+(r-1)*y,D,E):0==f%v?this.$context.drawImage(n,0,0,D,y,h+(v-1)*x,k+parseInt((f-1)/v)*y,D,y):f>(r-1)*v?this.$context.drawImage(n,0,0,x,E,h+parseInt((f-1)%v)*x,k+(r-1)*y,x,E):this.$context.drawImage(n,0,0,x,y,h+(f%v-1)*x,k+parseInt((f-1)/v)*y,x,y)}else{var I,J;switch(z){case "repeat-x":G=parseInt(f/n.width);D=f%n.width;E=q<n.height?q:n.height;I=n.width;J=0;x=
f<n.width?f:n.width;break;case "repeat-y":G=parseInt(q/n.height),E=q%n.height,D=f<n.width?f:n.width,I=0,J=n.height,y=q<n.height?q:n.height}for(f=0;f<=G;f++)f==G?this.$context.drawImage(n,0,0,D,E,h+f*I,k+f*J,D,E):this.$context.drawImage(n,0,0,x,y,h+f*I,k+f*J,x,y)}h=C?C:h;k=K?K:k;a.$x=h;a.$y=k;break;case "path":if(a.$temp||!$element){if(!$element&&"string"==typeof a.border||"string"==typeof a.border&&$element&&$element.border!=a.border)p=a.border.split(" "),e=m(p[0],0,g.borderWidth),this.$context.lineWidth=
e,c=p[2]||g.borderColor,this.$context.strokeStyle=c;e||(e=m(a.borderWidth,$element&&$element.borderWidth,g.borderWidth),this.$context.lineWidth=e);c||(c=a.borderColor||g.borderColor,this.$context.strokeStyle=c);a.borderWidth=e;a.borderColor=c;a.border=e+" solid "+c;a.lineJoin&&M.indexOf(a.lineJoin)&&(this.$context.lineJoin=a.lineJoin);if(a.line&&"object"==typeof a.line){h=0;a.figure=void 0===a.figure?g.figure:a.figure;event.line||(event.line=[]);this.$context.beginPath();a.translateX&&(a.translateX=
m(u(this.$canvas.width,a.translateX,g.translate.x),$element&&$element.translateX,g.translate.x));a.translateY&&(a.translateY=m(u(this.$canvas.height,a.translateY,g.translate.y),$element&&$element.translateY,g.translate.y));k="number"==typeof a.translateX?a.translateX:g.translate.x;C="number"==typeof a.translateY?a.translateY:g.translate.y;this.$context.translate(k,C);if("number"!=typeof a.line[0][0]||"number"!=typeof a.line[0][1])h=1;else for(f=0;f<a.line.length;f++){if("number"!=typeof a.line[f][0]||
"number"!=typeof a.line[f][1]){h=1;break}a.line[f][0]=m(a.line[f][0],$element&&$element.line&&$element.line[f][0]||0,0);a.line[f][1]=m(a.line[f][1],$element&&$element.line&&$element.line[f][1]||0,0);event.line[f]||(event.line[f]={});event.line[f][0]=a.line[f][0]+k;event.line[f][1]=a.line[f][1]+C;0==f?this.$context.moveTo(a.line[0][0],a.line[0][1]):this.$context.lineTo(a.line[f][0],a.line[f][1])}if(!0===a.figure||"true"==a.figure)a.figure=!0,this.$context.closePath();0==h&&(a.background&&!0===a.figure&&
(this.$context.fillStyle=a.background,this.$context.fill()),this.$context.stroke())}delete a.$temp}else{this.$context.lineJoin=a.lineJoin;this.$context.lineWidth=a.borderWidth;this.$context.strokeStyle=a.borderColor;this.$context.beginPath();this.$context.translate("number"==typeof a.translateX?a.translateX:g.translate.x,"number"==typeof a.translateY?a.translateY:g.translate.y);for(f=0;f<(event.line&&event.line.length);f++)0==f?this.$context.moveTo(a.line[0][0],a.line[0][1]):this.$context.lineTo(a.line[f][0],
a.line[f][1]);if(!0===a.figure||"true"==a.figure)a.figure=!0,this.$context.closePath();a.background&&!0===a.figure&&(this.$context.fillStyle=a.background,this.$context.fill());this.$context.stroke()}break;case "circle":if(a.$temp||!$element){h=m(a.x,$element&&$element.x||0,g.circle.x);k=m(a.y,$element&&$element.y||0,g.circle.y);isR1=!$element&&a.r1||$element&&$element.r1!=a.r1;isR2=!$element&&a.r2||$element&&$element.r2!=a.r2;if(!$element&&"string"==typeof a.r||$element&&$element.r!=a.r)C="string"==
typeof a.r?a.r.split(" "):0,a.r1=isR1?a.r1:m(C[0],$element&&$element.r1||0,g.circle.r),a.r2=isR2?a.r2:m(C[1],$element&&$element.r2||0,a.r1);isR1&&(a.r1=m(a.r1,$element&&$element.r1||0,0));isR2&&(a.r2=m(a.r2,$element&&$element.r2||0,0));a.r1||(a.r1=g.circle.r);a.r2||(a.r2=g.circle.r);a.r=a.r1+" "+a.r2;if(!$element&&"string"==typeof a.border||"string"==typeof a.border&&$element&&$element.border!=a.border)p=a.border.split(" "),e=m(p[0],0,g.borderWidth),this.$context.lineWidth=e,c=p[2]||g.borderColor,
this.$context.strokeStyle=c;e||(e=m(a.borderWidth,$element&&$element.borderWidth||0,g.borderWidth),this.$context.lineWidth=e);c||(c=a.borderColor||g.borderColor,this.$context.strokeStyle=c);a.borderWidth=e;a.borderColor=c;a.border=e+" solid "+c;a.start||(a.start=g.circle.start);a.end||(a.end=g.circle.end);a.clock||(a.clock=g.circle.clock);p="string"==typeof a.origin?a.origin.split(" "):g.origin;h-=u(2*a.r1,p[0],g.origin[0]);k-=u(2*a.r2,p[1],g.origin[1]);this.$context.beginPath();a.r2&&a.r1!=a.r2?
this.$context.ellipse(h,k,a.r1,a.r2,0,a.start,a.end,!1):this.$context.arc(h,k,a.r1,a.start,a.end,a.clock);a.background&&(this.$context.fillStyle=a.background,this.$context.fill());0<a.borderWidth&&this.$context.stroke();"object"!=typeof event.c&&(event.c={});a.r1>a.r2?(event.c.x=Math.sqrt((a.r1-a.r2)*(a.r1+a.r2))+h,event.c.y=k,event.c.mirrorx=-event.c.x+2*h,event.c.mirrory=k,event.a=a.r1,event.mirror=!0):a.r1==a.r2?(event.c.x=h,event.c.y=k,event.c.mirrorx=h,event.c.mirrory=k,event.a=a.r1,event.mirror=
!0):(event.c.y=Math.sqrt((a.r2-a.r1)*(a.r1+a.r2))+k,event.c.x=h,event.c.mirrorx=h,event.c.mirrory=-event.c.y+2*k,event.a=a.r2,event.mirror=!1);a.$x=h;a.$y=k;delete a.$temp}else this.$context.beginPath(),a.r2&&a.r1!=a.r2?this.$context.ellipse(a.$x,a.$y,a.r1,a.r2,0,a.start,a.end,!1):this.$context.arc(a.$x,a.$y,a.r1,a.start,a.end,a.clock),a.background&&(this.$context.fillStyle=a.background,this.$context.fill()),0<a.borderWidth&&this.$context.stroke();break;case "text":h="string"==typeof a.content||"number"==
typeof a.content?a.content:g.content,this.$context.font=(a.fontSize||g.fontSize)+"px "+(a.fontFamily||g.fontFamily),a.x=m(a.x,$element&&$element.x,g.x),a.y=m(a.y,$element&&$element.y,g.y),this.$context.fillText(h,a.x,a.y)}this.$element[w[l]]=a;this.$context.restore()}};Canvas.prototype.element=function(b){if(!this.$canvas)return console.error("CvSS ERROR : not found element"),0;if(b==this)return this.$windowEvent;this.$cvss_target="string"==typeof b||"number"==typeof b?String(b):void 0;return this};
Canvas.prototype.cvss=function(b,d){if(!this.$element[this.$cvss_target])return console.error("CvSS ERROR : not found element"),0;var e={};if(!d&&""!=d||"string"!=typeof b){if("[object Array]"===Object.prototype.toString.call(b)){for(var c={},e=0;e<b.length;e++)c[b[e]]=this.$element[this.$cvss_target][b[e]];return c}if("object"==typeof b)e[this.$cvss_target]=Canvas.prototype.setBaseObj(this.$element[this.$cvss_target],b,!0),this.createElement(e);else if(this.$element[this.$cvss_target]&&this.$element[this.$cvss_target][b])return"object"==
typeof this.$element[this.$cvss_target][b]?Canvas.prototype.CopyObj(this.$element[this.$cvss_target][b]):this.$element[this.$cvss_target][b]}else e[this.$cvss_target]=Canvas.prototype.CopyObj(this.$element[this.$cvss_target]),e[this.$cvss_target][b]=d,this.createElement(e)};Canvas.prototype.getInfo=function(){return this.$element[this.$cvss_target]?Canvas.prototype.CopyObj(this.$element[this.$cvss_target]):(console.error("CvSS ERROR : not found element"),0)};Canvas.prototype.create=function(b){var d=
[];d[this.$cvss_target]=b;this.createElement(d)};Canvas.prototype.remove=function(){if(!this.$element[this.$cvss_target])return console.error("CvSS ERROR : not found element"),0;delete this.$element[this.$cvss_target];delete this.$eventFunc[this.$cvss_target];this.$cvss_target=void 0;this.createElement(this.$element)};Canvas.prototype.submitEvent=function(b,d){if("string"!=typeof b||-1==Canvas.prototype.$Element_Event.indexOf(b)||"function"!=typeof d)return 0;"object"!=typeof this.$eventFunc[this.$cvss_target]&&
(this.$eventFunc[this.$cvss_target]={});this.$eventFunc[this.$cvss_target][b]=d};Canvas.prototype.mousedown=function(b){this.submitEvent("mousedown",b)};Canvas.prototype.mouseup=function(b){this.submitEvent("mouseup",b)};Canvas.prototype.dblclick=function(b){this.submitEvent("dblclick",b)};Canvas.prototype.mousein=function(b){this.submitEvent("mousein",b)};Canvas.prototype.mouseout=function(b){this.submitEvent("mouseout",b)};Canvas.prototype.dragstart=function(b){this.submitEvent("dragstart",b)};
Canvas.prototype.drag=function(b){this.submitEvent("drag",b)};Canvas.prototype.drop=function(b){this.submitEvent("drop",b)};Canvas.prototype.hover=function(b,d){"function"==typeof b&&this.submitEvent("mousein",b);"function"==typeof d&&this.submitEvent("mouseout",d)};Canvas.prototype.click=function(b){"object"!=typeof this.$eventFunc[this.$cvss_target]&&(this.$eventFunc[this.$cvss_target]={});this.$eventFunc[this.$cvss_target].click=b};Canvas.prototype.hide=function(b){this.$element[this.$cvss_target]&&
(this.$element[this.$cvss_target].show=!1,this.createElement(this.$element));return 0};Canvas.prototype.show=function(b){this.$element[this.$cvss_target]&&(this.$element[this.$cvss_target].show=!0,this.createElement(this.$element));return 0};Canvas.prototype.bind=function(b,d){if("string"!=typeof b)return console.warn("Cvss Warning : bind's events is string"),0;b=b.split(" ");var e;for(e=0;e<b.length;e++)-1!=Canvas.prototype.$Element_Event.indexOf(b[e])&&this.submitEvent(b[e],d)};Canvas.prototype.unbind=
function(b){if("string"!=typeof b)return console.warn("Cvss Warning : bind's events is string"),0;b=b.split(" ");var d;for(d=0;d<b.length;d++)if(-1!=Canvas.prototype.$Element_Event.indexOf(b[d])&&this.$eventFunc[this.$cvss_target])return delete this.$eventFunc[this.$cvss_target][b[d]],1;return 0};Canvas.prototype.$initElement={translate:{x:0,y:0},scale:{x:0,y:0},zindex:0,type:"block",width:100,height:50,x:0,y:0,background:"rgba(0,0,0,0)",opacity:1,origin:["0","0"],circle:{x:0,y:0,r:10,start:0,end:2*
Math.PI,clock:!0},backgroundImage:{src:void 0,pattern:"no-repeat"},border:[1],cursor:"default",fontSize:"12px",fontFamily:"Arial",borderColor:"black",borderWidth:0,content:"",figure:!0,rotate:0,rotateOrigin:{x:0,y:0}};Canvas.prototype.$Element_Type=["block","path","circle","text"];Canvas.prototype.$Element_Event="mouseup mousedown click mousein mouseout dblclick dragstart drag drop".split(" ");Canvas.prototype.$lineJoin=["miter","round","bevel"];Canvas.prototype.$backgroundRepeatType=["no-repeat",
"repeat","repeat-y","repeat-x"];Canvas.prototype.CopyObj=function(b){return b?JSON.parse(JSON.stringify(b)):{}}})(window);